<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Crash Game Final</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to bottom, #0f0c29, #302b63, #24243e);
      color: white;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      overflow: hidden;
    }
    #wallet {
      font-size: 1.3em;
      text-align: center;
      padding: 10px 0;
    }
    #game-container {
      position: relative;
      flex: 1;
      background: radial-gradient(circle at 50% 80%, #1a1a2e, #0f0c29);
      overflow: hidden;
    }
    #plane {
      position: absolute;
      width: 250px;
      bottom: 0;
      left: 0;
      display: none;
      user-select: none;
      pointer-events: none;
      will-change: transform;
      transition: transform 0.05s linear;
    }
    #multiplierFloat {
      position: absolute;
      color: #00ff99;
      font-weight: bold;
      font-size: 2.2em;
      user-select: none;
      pointer-events: none;
      text-shadow: 0 0 6px #00ff99;
    }
    #controls {
      padding: 15px 10px;
      background: #111;
      text-align: center;
    }
    #betAmount {
      width: 80px;
      font-size: 1.2em;
      padding: 8px;
      margin-bottom: 10px;
      text-align: center;
      border-radius: 6px;
      border: none;
    }
    .bet-options button {
      padding: 8px 15px;
      margin: 5px 4px;
      font-size: 1em;
      border-radius: 6px;
      border: none;
      background-color: #333;
      color: white;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .bet-options button:hover {
      background-color: #ff0066;
    }
    .btn {
      padding: 12px 25px;
      margin: 10px 10px 0 10px;
      font-size: 1.1em;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    #betBtn {
      background-color: #ff0066;
      color: white;
    }
    #betBtn:disabled {
      background-color: grey;
      cursor: not-allowed;
    }
    #cashOutBtn {
      background-color: #555;
      color: white;
    }
    #cashOutBtn:disabled {
      background-color: grey;
      cursor: not-allowed;
    }
    #countdown {
      font-size: 1em;
      margin-top: 10px;
      color: #aaa;
    }
  </style>
</head>
<body>

<div id="wallet">$100</div>

<div id="game-container">
  <img id="plane" src="https://cdn-icons-png.flaticon.com/512/1995/1995799.png" alt="Plane" />
  <div id="multiplierFloat">1.00x</div>
</div>

<div id="controls">
  <input type="number" id="betAmount" value="10" min="1" />
  <div class="bet-options">
    <button onclick="setBet(5)">5</button>
    <button onclick="setBet(10)">10</button>
    <button onclick="setBet(20)">20</button>
    <button onclick="setBet(1000)">1000</button>
  </div>
  <button class="btn" id="betBtn" onclick="placeBet()">وضع رهان</button>
  <button class="btn" id="cashOutBtn" onclick="cashOut()" disabled>سحب الأرباح</button>
  <div id="countdown"></div>
</div>

<audio id="flySound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_b208bd429.mp3?filename=jet-passby-118303.mp3"></audio>
<audio id="explosionSound" src="https://cdn.pixabay.com/download/audio/2021/09/01/audio_28472dc45.mp3?filename=explosion.mp3"></audio>

<script>
  const walletDisplay = document.getElementById('wallet');
  const plane = document.getElementById('plane');
  const multiplierFloat = document.getElementById('multiplierFloat');
  const betAmountInput = document.getElementById('betAmount');
  const betBtn = document.getElementById('betBtn');
  const cashOutBtn = document.getElementById('cashOutBtn');
  const countdownDisplay = document.getElementById('countdown');
  const flySound = document.getElementById('flySound');
  const explosionSound = document.getElementById('explosionSound');

  let wallet = 100;
  let multiplier = 1.00;
  let crashed = false;
  let playerIn = false;
  let positionX = 0;
  let positionY = 0;
  let gameInterval;
  let countdownInterval;

  function setBet(amount) {
    betAmountInput.value = amount;
  }

  function updateWallet() {
    walletDisplay.textContent = `$${wallet.toFixed(2)}`;
  }

  function resetGame() {
    multiplier = 1.00;
    crashed = false;
    playerIn = false;
    positionX = 0;
    positionY = 0;
    multiplierFloat.textContent = "1.00x";
    multiplierFloat.style.transform = `translate(${positionX + 140}px, ${-positionY + 120}px)`;
    plane.style.display = 'none';
    cashOutBtn.disabled = true;
    betBtn.disabled = false;
    countdownDisplay.textContent = "";
    clearInterval(gameInterval);
    clearInterval(countdownInterval);
  }

  function startCountdown(seconds = 5) {
    let count = seconds;
    countdownDisplay.textContent = `Next round in ${count} seconds`;
    countdownInterval = setInterval(() => {
      count--;
      countdownDisplay.textContent = `Next round in ${count} seconds`;
      if (count <= 0) {
        clearInterval(countdownInterval);
        countdownDisplay.textContent = "";
        startGame();
      }
    }, 1000);
  }

  function startGame() {
    flySound.play();
    plane.style.display = 'block';
    gameInterval = setInterval(() => {
      multiplier += 0.01;
      positionX += 5;
      positionY += 3;
      multiplierFloat.textContent = multiplier.toFixed(2) + "x";
      multiplierFloat.style.transform = `translate(${positionX + 140}px, ${-positionY + 120}px)`;
      plane.style.transform = `translate(${positionX}px, ${-positionY}px)`;
      if (Math.random() < 0.008 * multiplier || positionX > window.innerWidth) {
        crash();
      }
    }, 50);
  }

  function crash() {
    crashed = true;
    clearInterval(gameInterval);
    explosionSound.play();
    plane.style.display = 'none';
    multiplierFloat.style.display = 'none';
    if (playerIn) {
      wallet -= parseFloat(betAmountInput.value);
      updateWallet();
      تخورت.');
      playerIn = false;
    }
    setTimeout(() => {
      multiplierFloat.style.display = 'block';
      resetGame();
      startCountdown();
    }, 3000);
  }

  function placeBet() {
    if (!playerIn) {
      let bet = parseFloat(betAmountInput.value);
      if (bet > 0 && bet <= wallet) {
        playerIn = true;
        betBtn.disabled = true;
        cashOutBtn.disabled = false;
      } else {
        alert('رصيد غير كافي أو مبلغ غير صالح!');
      }
    }
  }

  function cashOut() {
    if (!crashed && playerIn) {
      clearInterval(gameInterval);
      let win = multiplier * parseFloat(betAmountInput.value);
      wallet += win;
      updateWallet();
      alert(`حويتهم $${win.toFixed(2)}!`);
      playerIn = false;
      cashOutBtn.disabled = true;
    }
  }

  updateWallet();
  resetGame();
  startCountdown();
</script>

</body>
</html>
